<!DOCTYPE html>
<html>
  <head>
    <base target='_top'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Google Fonts for signature-like font -->
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <!-- Font Awesome for timeline icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
      // Nếu đang trong iframe trên mobile, bẻ khung mở full page
      if (window.top !== window.self && /Mobi|Android/i.test(navigator.userAgent)) {
        if (window.location.href !== window.top.location.href) {
            window.top.location.href = window.location.href;
        }
      }
    </script>
    <style>
      html {
        font-size: 16px; /* Base font size */
      }

      *, *::before, *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        background-color: #a26e54; /* Màu nền mới */
        color: #F9EFE5; /* Màu chữ chính */
        font-family: 'Cambria', 'Times New Roman', serif;
        padding: 20px; /* Default padding for larger screens */
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        box-sizing: border-box;
        opacity: 0;
        animation: fadeInPage 0.8s ease-out forwards;
      }

      @keyframes fadeInPage {
        to { opacity: 1; }
      }

      h1 {
        font-family: 'SVN-Ameyallinda Signature', 'Brush Script MT', cursive;
        font-size: 3.25rem; /* 52px / 16px */
        color: #F9EFE5; /* Màu chữ cho tiêu đề */
        margin-bottom: 25px;
        font-weight: normal;
      }

      label {
        display: block;
        font-size: 16px;
        margin-bottom: 8px;
        font-family: 'Cambria Italic', 'Times New Roman', serif;
        font-style: italic;
        color: #F9EFE5; /* Màu chữ cho nhãn */
        text-align: left;
      }

      input[type='text'], input[type='number'] {
        width: 100%; /* Will fit due to box-sizing */
        padding: 12px;
        margin-bottom: 20px;
        border: 1px solid #DDCDBE; /* Softer border color */
        border-radius: 6px;
        font-family: 'Cambria', 'Times New Roman', serif;
        font-size: 16px;
        background-color: #fff;
        color: #a26e54; /* Màu chữ cho input */
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
      }

      input[type='text']:focus, input[type='number']:focus {
        border-color: #F9EFE5;
        box-shadow: 0 0 0 2px rgba(249, 239, 229, 0.2);
        outline: none;
      }

      button {
        background-color: #F9EFE5; /* Light cream text */
        color: #a26e54; /* Brown/copper from palette */
        padding: 12px 30px;
        border: none;
        border-radius: 6px;
        font-size: 18px;
        font-family: 'Cambria', 'Times New Roman', serif;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
        display: block;
        width: 100%; /* Full width button */
        margin-top: 10px; /* Space above button */
      }

      button:hover {
        background-color: #E5D3C8; /* Lighter shade on hover */
        transform: translateY(-2px);
      }

      #status {
        margin-top: 25px;
        color: #F9EFE5;
        font-family: 'Cambria', 'Times New Roman', serif;
        font-size: 17px;
        font-weight: bold;
        min-height: 25px; /* Reserve space for status message */
      }

      /* Responsive adjustments for smaller screens */
      @media (max-width: 600px) {
        body {
          padding: 15px;
        }
        h1 {
          font-size: 2.5rem; /* 40px / 16px - Smaller h1 for mobile */
        }
        label {
          font-size: 0.95rem; /* ~15px */
        }
        input[type='text'], input[type='number'] {
          padding: 10px;
          font-size: 0.95rem;
        }
        button {
          padding: 10px 20px;
          font-size: 1rem; /* 16px */
        }
        #status {
          font-size: 0.9rem; /* ~14.4px */
        }
      }

      /* Invitation Header */
      .invite-header {
        margin-bottom: 30px;
        overflow: hidden; /* crop overflow */
        position: relative;
      }
      .couple-names {
        font-family: 'Great Vibes', cursive;
        font-size: 2.5rem;
        color: #F9EFE5;
        margin-bottom: 5px;
      }
      .couple-names-image {
        width: 103%; /* larger than container for crop effect */
        height: auto;
        display: block;
        margin: 0;
        /* transform: translateX(-1.5%); offset image to the left */
      }
      .invite-date {
        font-family: 'Cambria', serif;
        font-size: 0.9rem;
        color: #F9EFE5;
        padding-top: 20px;
        margin-bottom: 3px;
        text-align: right;
        font-weight: bold;
      }
      .invite-location {
        font-family: 'Cambria', serif;
        font-size: 1rem;
        color: #F9EFE5;
        margin-bottom: 3px;
        text-align: right;
        font-weight: bold;
      }

      /* Timeline */
      .timeline {
        position: relative;
        display: flex;
        justify-content: space-between;
        align-items: flex-start; /* align items at top so line can center on icon */
        padding: 24px 0; /* top padding = half icon height to center line */
      }
      .timeline-item {
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 25%;
        z-index: 2;
      }
      .timeline-icon {
        font-size: 1.2rem; /* Kích thước hơi nhỏ hơn */
        color: #F9EFE5; /* Màu chữ cho icon timeline */
        background: transparent; /* Không fill nền */
        border: 1px solid #F9EFE5; /* Viền mỏng quanh icon */
        padding: 10px; /* Đệm bên trong viền */
        border-radius: 50%; /* Hình tròn */
        display: inline-block;
      }
      .timeline-text {
        margin-top: 8px;
        text-align: center;
      }
      .timeline-text .time {
        font-size: 0.85rem;
        color: #F9EFE5; /* Màu chữ cho thời gian */
      }
      .timeline-text .label {
        font-size: 0.75rem;
        color: #F9EFE5; /* Màu chữ cho nhãn */
        text-transform: uppercase;
        margin-top: 2px;
      }
      /* Waterfall effect for timeline icons and text */
      .timeline-item:nth-child(1) {
        transform: translateY(-20px);
      }
      .timeline-item:nth-child(2) {
        transform: translateY(10px);
      }
      .timeline-item:nth-child(3) {
        transform: translateY(40px);
      }
      .timeline-item:nth-child(4) {
        transform: translateY(60px);
      }
      /* Attendance toggle button */
      .attendance-btn {
        display: inline-block;
        margin: 20px auto 10px;
        border: none;
        border-radius: 6px;
        font-size: 18px;
        font-family: 'Cambria', 'Times New Roman', serif;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
        display: block;
        width: 100%; /* Full width button */
        margin-top: 10px; /* Space above button */
        background-color: #F9EFE5; /* Light cream text */
        color: #a26e54; /* Brown/copper from palette */
      }
      .attendance-btn.active {
        background-color: #F9EFE5; /* Màu nền cho nút tham dự khi active */
        color: #a26e54; /* Màu chữ cho nút tham dự khi active */
      }
      .dresscode {
        text-align: center;
        font-family: 'Cambria', serif;
        font-size: 0.9rem;
        color: #F9EFE5;
        margin-top: 50px;
      }
      /* Party-info slide-in and fade-in effect */
      .party-info {
        display: none;
        transform: translateX(50px);
        opacity: 0;
        transition: transform 0.5s ease-out, opacity 0.5s ease-out;
        margin-top: 40px;
      }
      .party-info.visible {
        display: block;
        transform: translateX(0);
        opacity: 1;
      }
      /* Dresscode styling */
      .dresscode-title {
        font-family: 'Cambria', serif;
        font-size: 1.1rem;
        color: #F9EFE5; /* Màu chữ cho tiêu đề dresscode */
        text-align: center;
        margin-top: 50px;
      }
      .dresscode-colors {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 10px;
      }
      .color-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        opacity: 0;
        transform: translateY(10px);
        transition: opacity 0.4s ease-out, transform 0.4s ease-out;
      }
      .color-item.visible {
        opacity: 1;
        transform: translateY(0);
      }
      .color-circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 2px solid #DDCDBE;
      }
      .color-label {
        font-family: 'Cambria', serif;
        font-size: 0.85rem;
        color: #F9EFE5; /* Màu chữ cho nhãn màu */
        margin-top: 5px;
      }

      .party-photo {
        display: block;
        width: 100%;
        max-width: 400px;
        margin: 30px auto 0;
      }

      .sorry-image {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        max-width: 80%;
        z-index: 1000;
        pointer-events: none;
        filter: drop-shadow(0 0 4px #fff);
        opacity: 1;
        transition: opacity 3s ease-out;
      }
      /* Sequential reveal for timeline items */
      .timeline-item {
        opacity: 0;
        transition: opacity 0.5s ease, transform 0.5s ease;
      }
      .timeline-item.visible {
        opacity: 1;
      }
      /* Dresscode section hidden until reveal */
      #dresscode-section {
        display: none;
        opacity: 0;
        transition: opacity 0.5s ease;
      }
      #dresscode-section.visible {
        display: block;
        opacity: 1;
      }
      /* Reveal on load for page elements */
      .reveal {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.6s ease-out, transform 0.6s ease-out;
      }
      .reveal.visible {
        opacity: 1;
        transform: translateY(0);
      }
    </style>
  </head>
  <body>
    <!-- Invitation Header -->
    <div class="invite-header reveal">
      <img src="https://raw.githubusercontent.com/hoangdo1510/nyandwill/main/aa-05.png" alt="Minh Quân & Thụy Ý" class="couple-names-image">
      <p class="invite-date">05.07.2025 | 15:30</p>
      <p class="invite-location">Sandy Beach Resort – Đà Nẵng</p>
    </div>
    <form id='rsvp-form' class='reveal'>
      <label for="nameInput">Name Name Name1</label>
      <input id="nameInput" type='text' name='name' required>
      
      <label for="guestsInput">Drop the number here</label>
      <input id="guestsInput" type='number' name='guests' min='1' value='1' required>
      
      <!-- Nút gửi thông tin -->
      <button type='submit' id="submitBtn">Count me in - Ready for unlimited buffet</button>
      
      <!-- Nút từ chối -->
      <button type="button" id="declineBtn" class="attendance-btn">Sorry, gotta skip (FOMO mode: ON)</button>
      
      <!-- Party information (hidden until user opts in) -->
      <div id="party-info" class="party-info" tabindex="-1">
        <!-- Timeline section -->
        <div id="timeline-section">
          <div class="timeline">
            <div class="timeline-item">
              <i class="fas fa-glass-martini timeline-icon"></i>
              <div class="timeline-text"><div class="time">16:00</div><div class="label">WELCOME DRINK</div></div>
            </div>
            <div class="timeline-item">
              <i class="fas fa-ring timeline-icon"></i>
              <div class="timeline-text"><div class="time">16:30</div><div class="label">CEREMONY</div></div>
            </div>
            <div class="timeline-item">
              <i class="fas fa-camera timeline-icon"></i>
              <div class="timeline-text"><div class="time">17:00</div><div class="label">GROUP PHOTO</div></div>
            </div>
            <div class="timeline-item">
              <i class="fas fa-utensils timeline-icon"></i>
              <div class="timeline-text"><div class="time">18:00</div><div class="label">RECEPTION DINNER</div></div>
            </div>
          </div>
        </div>
        <!-- Dresscode section -->
        <div id="dresscode-section" class="hidden">
          <div class="dresscode-title">Dresscode</div>
          <div class="dresscode-colors">
            <div class="color-item">
              <div class="color-circle" style="background:#A26F54;"></div>
              <div class="color-label">Brown</div>
            </div>
            <div class="color-item">
              <div class="color-circle" style="background:#F9EFE5;"></div>
              <div class="color-label">Beige</div>
            </div>
            <div class="color-item">
              <div class="color-circle" style="background:#FF6F30;"></div>
              <div class="color-label">Orange</div>
            </div>
          </div>
        </div>
        <img src="9b8f88fbbe990ac75388.jpg" alt="Party" class="party-photo">
      </div> <!-- end of party-info -->
      </form>
      <div id='status' class='reveal'></div>
    </div>

    <script>
      // Sequential reveal on page load
      window.addEventListener('load', () => {
        const loadItems = document.querySelectorAll('.reveal');
        loadItems.forEach((el, idx) => {
          setTimeout(() => el.classList.add('visible'), idx * 400);
        });
      });
      // Attendance toggle logic
      const partyInfo = document.getElementById('party-info');

      const form = document.getElementById('rsvp-form');
      const declineBtn = document.getElementById('declineBtn');

      function showSorryImage() {
        const img = document.createElement('img');
        img.src = 'Subject.png';
        img.className = 'sorry-image';
        document.body.appendChild(img);
        setTimeout(() => {
          img.style.opacity = '0';
        }, 1000);
        setTimeout(() => {
          img.remove();
        }, 4000);
      }
      function revealPartyInfo() {
        const partyInfoElement = document.getElementById('party-info');
        partyInfoElement.classList.add('visible');

        const timelineItems = partyInfoElement.querySelectorAll('.timeline-item');
        timelineItems.forEach((item, idx) => {
          setTimeout(() => item.classList.add('visible'), idx * 200);
        });

        const dresscodeSection = document.getElementById('dresscode-section');
        dresscodeSection.classList.remove('hidden');
        setTimeout(() => {
          dresscodeSection.classList.add('visible');
          const colorItems = dresscodeSection.querySelectorAll('.color-item');
          colorItems.forEach((item, idx) => {
            setTimeout(() => item.classList.add('visible'), idx * 150);
          });
        }, timelineItems.length * 200);
      }


      form.addEventListener('submit', e => {
        e.preventDefault();

        // Kiểm tra validation của form
        if (!form.checkValidity()) {
          form.reportValidity(); // Hiển thị thông báo lỗi mặc định của trình duyệt
          document.getElementById('status').innerText = 'Vui lòng điền đầy đủ và chính xác thông tin.';
          return;
        }

        const data = Object.fromEntries(new FormData(form).entries());
        // Lấy giá trị attendance từ hidden input
        data.attendance = true; // Đặt attendance là true khi nhấn nút gửi

        document.getElementById('status').innerText = 'Đang gửi...';
        google.script.run
          .withSuccessHandler(response => {
            if (response === 'success') {
              document.getElementById('status').innerText = 'Cảm ơn bạn đã phản hồi!';
              revealPartyInfo();
            } else {
              document.getElementById('status').innerText = 'Đã có lỗi xảy ra, vui lòng thử lại.';
            }
          })
          .withFailureHandler(error => {
             document.getElementById('status').innerText = 'Lỗi: ' + error.message;
          })
          .processForm(data);
      });

      // Logic cho nút từ chối
      declineBtn.addEventListener('click', () => {
        const nameInput = document.getElementById('nameInput');
        const guestsInput = document.getElementById('guestsInput');
        let isValid = true;

        // Kiểm tra validation thủ công
        if (nameInput.value.trim() === '') {
            nameInput.reportValidity();
            isValid = false;
        }
        if (guestsInput.value === '' || parseInt(guestsInput.value) < 1) {
            guestsInput.reportValidity();
            isValid = false;
        }

        if (!isValid) {
            document.getElementById('status').innerText = 'Vui lòng điền đầy đủ thông tin tên và số lượng khách.';
            return;
        }

        showSorryImage();

        const data = {
          name: nameInput.value,
          guests: guestsInput.value,
          attendance: false // Đặt attendance là false khi nhấn nút từ chối
        };

        document.getElementById('status').innerText = 'Đang gửi...';
        google.script.run
          .withSuccessHandler(response => {
            if (response === 'success') {
              document.getElementById('status').innerText = '';
              revealPartyInfo();
            } else {
              document.getElementById('status').innerText = 'Đã có lỗi xảy ra, vui lòng thử lại.';
            }
          })
          .withFailureHandler(error => {
             document.getElementById('status').innerText = 'Lỗi: ' + error.message;
          })
          .processForm(data);
      });
    </script>
  </body>
</html> 